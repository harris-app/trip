function TripService(n,t){var i=n("data/place.json",{},{getWelcomeData:{method:"GET",url:"data/welcome.json?v="+window.version},getSchoolData:{method:"GET",url:"data/school.json?v="+window.version}});return{getWelcomeData:function(){var n=t.defer();return i.getWelcomeData({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},getSchoolData:function(){var n=t.defer();return i.getSchoolData({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise}}}function WelcomeController(n,t){t.getWelcomeData().then(function(n){for(var u,e,f="#00f",i=[],t=0;t<n.targetGroups.length;t++){var o=n.targetGroups[t].color,s=n.targetGroups[t].targets,r={coordinateSystem:"bmap",zlevel:2,label:{normal:{position:"right",formatter:"{b}"},emphasis:{show:!0}},itemStyle:{normal:{color:o}},data:s};switch(n.targetGroups[t].category){case"want":r.type="scatter";symbolSize=1;r.rippleEffect={brushType:"stroke"};break;case"already":r.type="effectScatter";symbolSize=5}i.push(r)}i.push({coordinateSystem:"bmap",type:"lines",zlevel:1,effect:{show:!0,period:6,trailLength:.7,color:"#fff",symbolSize:3},lineStyle:{normal:{color:f,width:0,curveness:.2}},data:n.trips});i.push({coordinateSystem:"bmap",type:"lines",zlevel:2,symbol:["none","arrow"],symbolSize:10,effect:{show:!0,period:6,trailLength:0,symbol:"path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z",symbolSize:15},lineStyle:{normal:{color:f,width:1,opacity:.6,curveness:.2}},data:n.trips});option={bmap:{center:[116.4551,40.2539],zoom:5,roam:!0},series:i};u=echarts.init(document.getElementById("main"));u.setOption(option);e=u.getModel().getComponent("bmap").getBMap();e.addControl(new BMap.MapTypeControl)})}function SchoolController(n,t){t.getSchoolData().then(function(n){for(var e,r,o,u=[],s=n.color,t=n.targets,i=0;i<t.length;i++){var h=t[i].value[0],c=t[i].value[1],f=(new BMap.MercatorProjection).pointToLngLat(new BMap.Pixel(h,c));t[i].value=[f.lng,f.lat]}e={coordinateSystem:"bmap",type:"effectScatter",zlevel:2,symbolSize:5,label:{normal:{position:"right",formatter:"{b}"},emphasis:{show:!0}},itemStyle:{normal:{color:s}},data:t};u.push(e);option={bmap:{center:[120.945685,32.25196],zoom:11,roam:!0},series:u};r=echarts.init(document.getElementById("main"));r.setOption(option);o=r.getModel().getComponent("bmap").getBMap();o.addControl(new BMap.MapTypeControl)})}function GoogleController(){var n={lat:35.54935,lng:139.779871},t=new google.maps.Map(document.getElementById("mainMap"),{center:n,zoom:7}),i=new google.maps.DirectionsRenderer({map:t}),r={destination:{lat:35.70221,lng:139.774091},origin:n,travelMode:"DRIVING"},u=new google.maps.DirectionsService;u.route(r,function(n,t){console.log(n);t=="OK"&&i.setDirections(n)})}